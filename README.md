# rotor-2d

This code computes the single-rotor wavefunctions of the vGH Ansatz for the 2D rotor-lattice polaron model. There are three different file types:

    - Class files that outsource the classes necessary for calculation and analysis
    - Computation files to solve the equations of motion
    - Analysis files to compute energies, polaron size, effective mass, ...
	
The latter two use the classes defined in the class files. 

### Input files for real time propagation

The parameters of a computation are defined in an input file that has the following structure:

> n 256 <br>
> M 2800 <br>
> Mx 28 <br>
> My 100 <br>
> B 1.0 <br>
> tx 50 <br>
> ty 100 <br>
> V_0 80 <br>
> qx 0 <br>
> qy 0 <br>
> dt 0.001 <br>
> time_steps 100 <br> 

The real time propagation can then be started through the following structure:

> python3 real_time_propagation.py PATH_TO_CALCULATION_INPUT_FILE/INPUT_FILE.in

The analysis is specified by a separate input script with the structure:

> Mx_select 4 <br>
> My_select 4 <br>
> plot_densities y <br>
> plot_polaron_size n <br>

The analysis can be performed by calling:

> python3 a8_wavefunctions_real_time_propagation.py PATH_TO_CALCULATION_INPUT_FILE/INPUT_FILE.in PATH_TO_ANALYSIS_INPUT_FILE/INPUT_FILE.in

An example calculation can be done with the demo input file provided:

> python3 real_time_propagation.py input_scripts/test_real_time_prop/sim_1_tx_50_ty_100_Vmin_80_Vmax_80_B_1.0_M_100_qx_0_qy_0.in

and 

> python3 a8_wavefunctions_real_time_propagation.py input_scripts/test_real_time_prop/sim_1_tx_50_ty_100_Vmin_80_Vmax_80_B_1.0_M_100_qx_0_qy_0.in input_scripts/test_real_time_prop/sim_1_analysis_tx_50_ty_100_Vmin_80_Vmax_80_B_1.0_M_100_qx_0_qy_0.in

### Folder structure generated by scripts

When running the computation and analysis scripts, the following folder structure is generated (should be automatically, otherwise make sure manually):

    .
    ├── ...
    ├── image_results                                                                       # contains basically all analysis results
    │   └── psi_rotors_2d_python_M_36_B_1.0_tx_10.0_ty_100.0_Vmin_0.0_Vmax_300.0_complete   # example calculation - file name specifies parameters
    │       ├── configurations        # densities and or phases 
    │       ├── coupling_of_states    
    │       ├── effective_mass        # effective mass results
    │       ├── energies              # energies of the forward and backward scan
    │       └── polaron_size          # polaron size results
    └── matrix_results
    	└── psi_rotors_2d_python_M_2800_B_1.0_tx_50.0_ty_100.0_V1st_0.0_Vjump_120.0_Vnumber_21
    	
This folder structure should help to organize parameters and the results of the calculation - making the connection between them as transparent as possible.

### Note on error checking

All important calculations are specified in the class files!


